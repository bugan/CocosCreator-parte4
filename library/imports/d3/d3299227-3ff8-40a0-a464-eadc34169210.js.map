{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\Jogador.js"],"names":["Teclado","require","cc","Class","extends","Component","properties","_vidaAtual","Float","vidaMaxima","_direcao","Vec2","tiro","Prefab","_movimentacao","_controleAnimacao","_canvas","Canvas","_camera","Node","_audioTiro","AudioSource","onLoad","getComponent","find","on","atirar","mudarDirecaoDaAnimcao","node","sofrerDano","update","deltaTime","setDirecao","andarPraFrente","ZERO","estaPressionada","KEY","a","x","d","s","y","w","evento","detail","dano","eventoPerdeVida","Event","EventCustom","setUserData","vidaAtual","dispatchEvent","jogoAcabou","event","direcao","calcularDirecaoMouse","estado","mag","mudaAnimacao","posicaoMouse","getLocation","convertToNodeSpaceAR","posicaoJogadora","position","sub","disparo","instantiate","iniciliza","parent","play"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAaL,GAAGM,KADR;AAERC,oBAAaP,GAAGM,KAFR;AAGRE,kBAAWR,GAAGS,IAHN;AAIRC,cAAOV,GAAGW,MAJF;AAKRC,uBAAgBZ,GAAGG,SALX;AAMRU,2BAAoBb,GAAGG,SANf;AAORW,iBAAUd,GAAGe,MAPL;AAQRC,iBAAUhB,GAAGiB,IARL;;AAURC,oBAAalB,GAAGmB;;AAVR,KAHP;;AAkBLC,YAAQ,kBAAY;;AAEhB,aAAKR,aAAL,GAAqB,KAAKS,YAAL,CAAkB,cAAlB,CAArB;AACA,aAAKR,iBAAL,GAAyB,KAAKQ,YAAL,CAAkB,oBAAlB,CAAzB;AACA,aAAKH,UAAL,GAAkB,KAAKG,YAAL,CAAkBrB,GAAGmB,WAArB,CAAlB;AACA,aAAKL,OAAL,GAAed,GAAGsB,IAAH,CAAQ,QAAR,CAAf;AACA,aAAKR,OAAL,CAAaS,EAAb,CAAgB,WAAhB,EAA6B,KAAKC,MAAlC,EAA0C,IAA1C;AACA,aAAKV,OAAL,CAAaS,EAAb,CAAgB,WAAhB,EAA6B,KAAKE,qBAAlC,EAAyD,IAAzD;AACA,aAAKT,OAAL,GAAehB,GAAGsB,IAAH,CAAQ,QAAR,CAAf;AACA,aAAKI,IAAL,CAAUH,EAAV,CAAa,WAAb,EAA0B,KAAKI,UAA/B,EAA2C,IAA3C;AACA,aAAKtB,UAAL,GAAkB,KAAKE,UAAvB;AACH,KA7BI;;AA+BLqB,YAAQ,gBAAUC,SAAV,EAAqB;AACzB,aAAKjB,aAAL,CAAmBkB,UAAnB,CAA8B,KAAKtB,QAAnC;AACA,aAAKI,aAAL,CAAmBmB,cAAnB;;AAEA,aAAKvB,QAAL,GAAgBR,GAAGS,IAAH,CAAQuB,IAAxB;;AAEA,YAAGlC,QAAQmC,eAAR,CAAwBjC,GAAGkC,GAAH,CAAOC,CAA/B,CAAH,EAAqC;AACjC,iBAAK3B,QAAL,CAAc4B,CAAd,IAAkB,CAAlB;AACH;AACD,YAAGtC,QAAQmC,eAAR,CAAwBjC,GAAGkC,GAAH,CAAOG,CAA/B,CAAH,EAAqC;AACjC,iBAAK7B,QAAL,CAAc4B,CAAd,IAAkB,CAAlB;AACH;;AAEA,YAAGtC,QAAQmC,eAAR,CAAwBjC,GAAGkC,GAAH,CAAOI,CAA/B,CAAH,EAAqC;AAClC,iBAAK9B,QAAL,CAAc+B,CAAd,IAAkB,CAAlB;AACH;AACD,YAAGzC,QAAQmC,eAAR,CAAwBjC,GAAGkC,GAAH,CAAOM,CAA/B,CAAH,EAAqC;AACjC,iBAAKhC,QAAL,CAAc+B,CAAd,IAAkB,CAAlB;AACH;AACJ,KAlDI;;AAoDLZ,gBAAY,oBAASc,MAAT,EAAgB;AACxB,aAAKpC,UAAL,IAAmBoC,OAAOC,MAAP,CAAcC,IAAjC;AACA,YAAIC,kBAAkB,IAAI5C,GAAG6C,KAAH,CAASC,WAAb,CAAyB,oBAAzB,EAA+C,IAA/C,CAAtB;AACAF,wBAAgBG,WAAhB,CAA4B,EAACC,WAAY,KAAK3C,UAAlB,EAAgCE,YAAa,KAAKA,UAAlD,EAA5B;AACA,aAAKmB,IAAL,CAAUuB,aAAV,CAAwBL,eAAxB;AACA,YAAG,KAAKvC,UAAL,GAAiB,CAApB,EAAsB;AAClB,gBAAI6C,aAAa,IAAIlD,GAAG6C,KAAH,CAASC,WAAb,CAAyB,YAAzB,EAAuC,IAAvC,CAAjB;AACA,iBAAKpB,IAAL,CAAUuB,aAAV,CAAwBC,UAAxB;AACH;AACJ,KA7DI;;AA+DLzB,2BAAwB,+BAAS0B,KAAT,EAAe;AACnC,YAAIC,UAAU,KAAKC,oBAAL,CAA0BF,KAA1B,CAAd;AACA,YAAIG,eAAJ;AACA,YAAG,KAAK9C,QAAL,CAAc+C,GAAd,MAAuB,CAA1B,EAA4B;AACxBD,qBAAS,QAAT;AACH,SAFD,MAEK;AACDA,qBAAS,OAAT;AACH;AACD,aAAKzC,iBAAL,CAAuB2C,YAAvB,CAAoCJ,OAApC,EAA6CE,MAA7C;AACH,KAxEI;;AA0ELD,0BAAuB,8BAASF,KAAT,EAAe;AAClC,YAAIM,eAAeN,MAAMO,WAAN,EAAnB;AACAD,uBAAe,IAAIzD,GAAGS,IAAP,CAAYgD,aAAarB,CAAzB,EAA4BqB,aAAalB,CAAzC,CAAf;AACAkB,uBAAe,KAAK3C,OAAL,CAAa6C,oBAAb,CAAkCF,YAAlC,CAAf;AACA,YAAIG,kBAAkB,KAAK5C,OAAL,CAAa2C,oBAAb,CAAkC,KAAKjC,IAAL,CAAUmC,QAA5C,CAAtB;;AAEA,YAAIT,UAAUK,aAAaK,GAAb,CAAiBF,eAAjB,CAAd;AACA,eAAOR,OAAP;AACH,KAlFI;;AAoFL5B,YAAS,gBAAS2B,KAAT,EAAe;AACpB,YAAIC,UAAU,KAAKC,oBAAL,CAA0BF,KAA1B,CAAd;AACA,YAAIY,UAAU/D,GAAGgE,WAAH,CAAe,KAAKtD,IAApB,CAAd;AACAqD,gBAAQ1C,YAAR,CAAqB,MAArB,EAA6B4C,SAA7B,CAAuC,KAAKvC,IAAL,CAAUwC,MAAjD,EAAwD,KAAKxC,IAAL,CAAUmC,QAAlE,EAA4ET,OAA5E;;AAEA,aAAKlC,UAAL,CAAgBiD,IAAhB;AACH;;AA1FI,CAAT","file":"Jogador.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["let Teclado = require(\"Teclado\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _vidaAtual : cc.Float,\n        vidaMaxima : cc.Float,\n        _direcao : cc.Vec2,\n        tiro : cc.Prefab,\n        _movimentacao : cc.Component,\n        _controleAnimacao : cc.Component,\n        _canvas : cc.Canvas,\n        _camera : cc.Node,\n        \n        _audioTiro : cc.AudioSource,\n\n    },\n\n\n    onLoad: function () {\n       \n        this._movimentacao = this.getComponent(\"Movimentacao\");\n        this._controleAnimacao = this.getComponent(\"ControleDeAnimacao\");\n        this._audioTiro = this.getComponent(cc.AudioSource);\n        this._canvas = cc.find(\"Canvas\");\n        this._canvas.on(\"mousedown\", this.atirar, this);\n        this._canvas.on(\"mousemove\", this.mudarDirecaoDaAnimcao, this);\n        this._camera = cc.find(\"Camera\");\n        this.node.on(\"SofreDano\", this.sofrerDano, this);\n        this._vidaAtual = this.vidaMaxima;\n    },\n\n    update: function (deltaTime) {\n        this._movimentacao.setDirecao(this._direcao);\n        this._movimentacao.andarPraFrente();\n\n        this._direcao = cc.Vec2.ZERO;\n        \n        if(Teclado.estaPressionada(cc.KEY.a)){\n            this._direcao.x -=1;\n        }\n        if(Teclado.estaPressionada(cc.KEY.d)){\n            this._direcao.x +=1;\n        }\n        \n         if(Teclado.estaPressionada(cc.KEY.s)){\n            this._direcao.y -=1;\n        }\n        if(Teclado.estaPressionada(cc.KEY.w)){\n            this._direcao.y +=1;\n        }\n    },\n\n    sofrerDano: function(evento){\n        this._vidaAtual -= evento.detail.dano;\n        let eventoPerdeVida = new cc.Event.EventCustom(\"JogadoraPerdeuVida\", true);\n        eventoPerdeVida.setUserData({vidaAtual : this._vidaAtual ,  vidaMaxima : this.vidaMaxima});\n        this.node.dispatchEvent(eventoPerdeVida);\n        if(this._vidaAtual <0){\n            let jogoAcabou = new cc.Event.EventCustom(\"JogoAcabou\", true);\n            this.node.dispatchEvent(jogoAcabou);\n        }\n    },\n\n    mudarDirecaoDaAnimcao : function(event){\n        let direcao = this.calcularDirecaoMouse(event);\n        let estado;\n        if(this._direcao.mag() == 0){\n            estado = \"Parado\";\n        }else{\n            estado = \"Andar\";\n        }\n        this._controleAnimacao.mudaAnimacao(direcao, estado);\n    },\n\n    calcularDirecaoMouse : function(event){\n        let posicaoMouse = event.getLocation();\n        posicaoMouse = new cc.Vec2(posicaoMouse.x, posicaoMouse.y);\n        posicaoMouse = this._canvas.convertToNodeSpaceAR(posicaoMouse);\n        let posicaoJogadora = this._camera.convertToNodeSpaceAR(this.node.position);\n\n        let direcao = posicaoMouse.sub(posicaoJogadora);\n        return direcao;\n    },\n\n    atirar : function(event){\n        let direcao = this.calcularDirecaoMouse(event);\n        let disparo = cc.instantiate(this.tiro);  \n        disparo.getComponent(\"Tiro\").iniciliza(this.node.parent,this.node.position, direcao);\n\n        this._audioTiro.play();\n    },\n    \n    \n    \n    \n    \n    \n    \n\n});\n"]}